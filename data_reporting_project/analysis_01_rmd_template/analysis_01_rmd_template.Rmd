---
title: "Data Reporting Project"
author: Kelly Livingston, Allison Mollenkamp, Carmen Molina Acosta, Chris Barylick
date: "4/4/2021"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are reverse engineering the story, Out of control
17 years. 179 victims. The deadly toll of street racing in Los Angeles (https://www.latimes.com/projects/la-me-street-racing/).

## Install 

```{r}

install.packages ("sf")

```

## Load libraries

Loading required libraries for this analysis.

```{r}
# Load the tidyverse
library(tidyverse)

library(sf)

library(lubridate)

```

## Load and Cleaning Data

[In this block of text, describe the source of the data, and write a basic data dictionary for data you are working with]

```{r}
# Load required data
# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

street_racing_deaths <- read_csv("data/output/fatalities.csv")

street_racing_other <- read_csv("data/input/street-racing-fatalities.csv") %>%
  mutate(DeathDateTime = as_datetime(DeathDateTime)) %>%
  mutate(death_year = year(DeathDateTime))

glimpse(street_racing_other)

hoods <- st_read("data/input/hoods.shp") %>% as_tibble() %>%
  select(-geometry)

# Clean required data and prepare for analysis if needed. 


```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: [Valentina D’Alessandro] was one of at least 179 people who have died in Los Angeles County since 2000 in accidents where street racing was suspected, according to a Los Angeles Times analysis of coroner’s records, police reports and media accounts from 2000 to 2017.

* **Analysis summary**: We used the data from the street-racing-fatalities.csv file to give us a dataset with all of the deaths from the aggregated records, with the death year attached. After creating that file, titled, "street_racing_other," we were able to summarise the total deaths to recreate the Los Angeles Times' finding that at least 179 people had died in street racing accidents. 

```{r}
# Put code to reverse engineer sentence here

total_deaths <- street_racing_other %>%
  summarise(total_deaths = n())

# Display results of code below this codeblock

total_deaths

```

### Sentence 2

* **Sentence text**: The deadliest year on record was 2007, with 18 fatal crashes. After a period with relatively few recorded deaths, the count grew in recent years, with 15 fatalities in 2015, 11 in 2016 and 12 deaths in 2017, the Times analysis shows.

* **Analysis summary**: After creating the, "street_racing_other," file that included all of the deaths, regardless of whether they had been geo-located, along with the death year, we were able to group the deaths by year and summarise them. Arranging those grouped deaths in descending order confirmed the LA Times' finding that the deadliest year was 2007, with 18 deaths on record from street racing. 

```{r}

street_racing_difference <- street_racing_other %>%
  anti_join(street_racing_deaths, by = c("CaseNum" = "case_number"))

```

```{r}
# Put code to reverse engineer sentence here

deaths_by_year <- street_racing_other %>%
  group_by(death_year) %>% 
  summarise(deaths_by_year = n()) %>%
  arrange(desc(deaths_by_year))

# Display results of code below this codeblock

deaths_by_year

```

### Sentence 3

* **Sentence text**: The Times’ analysis found that at least 60 people died in crashes related to street racing in the city of Los Angeles between 2000 and 2017. Only two other cities in the county — Long Beach and Commerce — saw more than 10 deaths during that period.
* **Analysis summary**: We created a new file called "deaths_by_city" that took the data from "street_racing_deaths" and grouped it by city name. In doing this, we discovered the Times' reporters appear to have manually designated one extra death as happening in Los Angeles, so we attributed that case number to L.A. When we summarised and arranged the resulting death counts in descending order, it showed L.A. with 60 deaths and Long Beach and Commerce with 11 each. 


```{r}
# Put code to reverse engineer sentence here

deaths_by_city <- street_racing_deaths %>% 
  mutate(city_name=case_when(
   case_number == "2007-09388" ~ "los-angeles", 
    is.na(city) ~ name,
    TRUE ~ city
    )) %>%
  group_by(city_name) %>%
  summarise(count=n()) %>%
  arrange(desc(count))


# Display results of code below this codeblock

deaths_by_city

```

### Sentence 4

* **Sentence text**: The dead were overwhelmingly male and young: More than half were 21 or younger, including two children, ages 4 and 8, killed along with their mother. Slightly less than half of the victims— 47% — were behind the wheel. The rest were either passengers in the speeding vehicles, spectators or people simply walking on a sidewalk or driving home.
* **Analysis summary**: To confirm this finding, we had to arrange our data by demographics and the roles of those who'd died in the crashes. We created one file which used a "case_when" statement to categorize the victims as old or young based on whether they were younger or older than 21. We then grouped by gender and age to confirm the victims were mostly male and young. Then, we created another file to count and find the percentages of the roles each victim played, finding that 47% of the dead were suspected racers. 

```{r}
# Put code to reverse engineer sentence here

deaths_demo <- street_racing_other %>%
  mutate(old_young = case_when (
    Age <= 21 ~ "young", 
    TRUE ~ "old"
  )) %>%
  group_by(Gender,old_young) %>%
  summarise(count=n())

deaths_role <- street_racing_other %>%
  group_by(VictimRole) %>%
  summarise(role_count=n()) %>%
  mutate(role_percent=(role_count/sum(role_count))*100)
  
# Display results of code below this codeblock

deaths_demo

deaths_role

```

### Sentence 5

* **Sentence text**: Deaths have occurred all across L.A. County, with the biggest concentration in the small city of Commerce. Eleven have died on the small, industrial city’s streets since 2000.
* **Analysis summary**: We confirmed this finding by first counting the number of deaths that occurred in each city. We then created an additional file to calculate the number of deaths relative to the population of a city to find Commerce had the highest concentation of deaths, relative to its population. 

```{r}
# Put code to reverse engineer sentence here

deaths_by_hood <- street_racing_deaths %>%
  group_by(name) %>%
  summarise(death_count=n())

deaths_per_capita <- deaths_by_hood %>%
  left_join(hoods) %>%
  filter(population>1000) %>%
  mutate(per_capita = (death_count/population)*100) %>%
  arrange(desc(per_capita))

# Display results of code below this codeblock

deaths_per_capita

```

-30-